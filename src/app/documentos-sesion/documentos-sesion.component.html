<!-- =======================
   Barra superior fija
   ======================= -->
<app-barra-superior></app-barra-superior>

<!-- =======================
   Contenedor principal
   ======================= -->
<div class="main-container my-5">
  <!-- Título de la página con el nombre de la sesión -->
  <h2 class="text-center">Documentos {{ sesion?.nombre }}</h2>

  <app-boton-atras></app-boton-atras><br /><br />

  <!-- =======================
       Tabla contenedora de documentos
       ======================= -->
  <div class="documents-container">
    <table class="documents-table">
      <!-- Fila para subir nuevos archivos -->
      <tr>
        <td
          colspan="3"
          class="upload-container"
          [class.is-loading]="subiendoDocumento"
          [attr.aria-busy]="subiendoDocumento"
        >
          <label class="upload-label">
            <input
              #archivoInput
              type="file"
              class="file-input"
              [disabled]="subiendoDocumento"
              (change)="onFileSelected($event)"
            />
            <span *ngIf="!subiendoDocumento">Seleccionar archivo</span>
            <span *ngIf="subiendoDocumento">
              <span class="spinner-border spinner-border-sm me-2"></span>
              Subiendo…
            </span>
          </label>
        </td>
      </tr>

      <!-- Fila por cada documento subido -->
      <tr *ngFor="let documento of sesionDocumentos">
        <td class="document-name">
          {{ documento.documento.nombre }}
        </td>
        <td class="btn-container">
          <button
            class="btn btn-secondary"
            (click)="abrirDocumento(documento.documento)"
          >
            Ver
          </button>
        </td>
        <td class="text-center">
          <button
            class="btn btn-danger d-block mx-auto"
            (click)="eliminarDocumento(documento.documento.id_documento)"
            [disabled]="
              eliminandoDocumento.get(documento.documento.id_documento)
            "
          >
            <ng-container
              *ngIf="
                !eliminandoDocumento.get(documento.documento.id_documento);
                else cargandoEliminar
              "
            >
              <i class="bi bi-trash me-2"></i>
              Eliminar
            </ng-container>
            <ng-template #cargandoEliminar>
              <span class="spinner-border spinner-border-sm me-2"></span>
              Eliminando...
            </ng-template>
          </button>
        </td>
      </tr>
    </table>
  </div>
</div>

<app-footer></app-footer>
